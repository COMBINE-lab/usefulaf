name: simpleaf-check

on:
  push:
  pull_request:

jobs:
  test-simpleaf:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Add conda to system path
      run: |
        # $CONDA is an environment variable pointing to the root of the miniconda directory
        echo $CONDA/bin >> $GITHUB_PATH
    - name: Install dependencies
      run: |
        conda env update --file simpleaf_conda_env.yml --name base
    - name: Checkout roe repo
      uses: actions/checkout@v3
      with:
        repository: COMBINE-lab/roe
        path: roe
      run: Rscript -e "devtools::install(pkg="roe")"

    - name: Test simpleaf
      run: |
        cd bash
        chmod +x test_simpleaf.sh
        ./test_simpleaf.sh
    - name: Check job status
      run: echo "This job's status is ${{ job.status }}."